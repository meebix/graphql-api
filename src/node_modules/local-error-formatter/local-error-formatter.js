const defaultFormatter = require('./default-formatter');
const sequelizeFormatter = require('./sequelize-formatter');
const sparkPostFormatter = require('./sparkpost-formatter');
const jwtFormatter = require('./jwt-formatter');

/**
 * Determines the specific library error signature to be formatted
 *
 * @function
 * @param {Object} error - Express.js err
 * @returns {Object} - Formatted error object to be passed to formatError
 */
function formatError(err) {
  const name = err.name;

  switch (name) {
    case 'SequelizeValidationError':
      return sequelizeFormatter(err);
    case 'SparkPostError':
      return sparkPostFormatter(err);
    case 'TokenExpiredError':
    case 'JsonWebTokenError':
      return jwtFormatter(err);
    default:
      return defaultFormatter(err);
  }
}

module.exports = formatError;
